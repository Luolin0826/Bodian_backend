# Scripts表批量分类管理工具

## 功能概述

这套工具帮助你批量管理和调整scripts表中的分类信息。

## 文件说明

- `export_scripts_to_excel.py` - 导出scripts数据到Excel文件
- `import_scripts_from_excel.py` - 从Excel文件导入更新的分类数据
- `scripts_export_YYYYMMDD_HHMMSS.xlsx` - 生成的Excel文件

## 使用流程

### 1. 导出数据到Excel

```bash
python export_scripts_to_excel.py
```

这将生成一个包含3个工作表的Excel文件：
- **Scripts数据**: 包含所有脚本的详细信息
- **分类对照表**: 所有可用分类的ID和名称映射
- **分类统计**: 各分类下的脚本数量统计

### 2. 在Excel中编辑分类

打开生成的Excel文件，在"Scripts数据"工作表中：

1. **查看当前分类**: 
   - `分类ID` 列显示当前的分类ID
   - `分类名称` 列显示对应的分类名称

2. **参考分类对照表**:
   - 切换到"分类对照表"工作表查看所有可用分类
   - 记录你要使用的新分类ID

3. **修改分类**:
   - 在"Scripts数据"工作表的`分类ID`列中修改需要调整的脚本分类
   - 只需修改`分类ID`列，其他列保持不变

### 3. 导入修改后的数据

```bash
python import_scripts_from_excel.py scripts_export_20250909_125330.xlsx
```

系统会：
- 验证分类ID的有效性
- 只更新发生变化的记录
- 显示更新统计信息
- 自动更新记录的修改时间

### 4. 查看可用分类

```bash
python import_scripts_from_excel.py --categories
```

## Excel文件结构

### Scripts数据工作表
| 列名 | 说明 | 是否可编辑 |
|------|------|-----------|
| ID | 脚本唯一标识 | ❌ 不可修改 |
| 标题 | 脚本标题 | ❌ 仅供参考 |
| 问题 | 用户问题 | ❌ 仅供参考 |
| 答案 | 脚本答案 | ❌ 仅供参考 |
| 分类ID | 当前分类ID | ✅ **可编辑** |
| 分类名称 | 当前分类名称 | ❌ 仅供参考 |
| 关键词 | 脚本关键词 | ❌ 仅供参考 |
| 创建时间 | 记录创建时间 | ❌ 仅供参考 |
| 更新时间 | 记录更新时间 | ❌ 仅供参考 |

### 分类对照表工作表
显示所有可用的分类ID和名称，用于参考。

### 分类统计工作表
显示各分类下的脚本数量，便于了解分类分布情况。

## 当前导出结果

✅ **导出成功** - `scripts_export_20250909_125330.xlsx`

📊 **数据统计**:
- 脚本总数: **245** 条
- 分类总数: **11** 个  
- 未分类脚本: **0** 条

📈 **主要分类分布**:
- 复习规划: 57个
- 网申: 54个
- 产品介绍: 48个
- 电网: 46个
- 报考咨询: 40个

## 注意事项

1. **备份重要**: 在批量修改前，建议备份数据库
2. **分类ID验证**: 系统会自动验证分类ID的有效性
3. **只修改分类ID**: 只需修改"分类ID"列，其他列会自动忽略
4. **批量操作**: 支持一次性修改多个脚本的分类
5. **错误处理**: 无效的分类ID会被跳过并显示警告

## 高级功能

### 筛选和排序
在Excel中可以使用筛选功能快速找到需要调整的脚本：
- 按分类名称筛选
- 按关键词筛选  
- 按问题内容筛选

### 批量替换
使用Excel的查找替换功能可以快速批量修改分类：
- 选中"分类ID"列
- Ctrl+H 打开查找替换
- 输入要替换的分类ID

## 错误排查

### 常见错误
1. **分类ID不存在**: 检查分类对照表，使用有效的分类ID
2. **Excel文件格式**: 确保使用正确的Excel文件格式
3. **权限问题**: 确保有数据库写入权限

### 获取帮助
```bash
# 查看可用分类
python import_scripts_from_excel.py --categories

# 查看使用帮助
python import_scripts_from_excel.py
```