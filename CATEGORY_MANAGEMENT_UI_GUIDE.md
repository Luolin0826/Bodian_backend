# è¯æœ¯åˆ†ç±»ç®¡ç†UIç»„ä»¶ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æœ¬ç»„ä»¶æä¾›äº†ä¸€ä¸ªç¾è§‚ã€ç°ä»£åŒ–çš„è¯æœ¯åˆ†ç±»ç®¡ç†ç•Œé¢ï¼Œæ”¯æŒæ‹–æ‹½æ’åºã€å®æ—¶ä¿å­˜ã€è‡ªåŠ¨åˆ·æ–°ç­‰åŠŸèƒ½ã€‚ç•Œé¢é‡‡ç”¨ç°ä»£åŒ–è®¾è®¡ï¼Œç¬¦åˆç”¨æˆ·æ“ä½œä¹ æƒ¯ï¼Œæœ€å°åŒ–ç©ºç™½åŒºåŸŸï¼Œæä¾›æµç•…çš„äº¤äº’ä½“éªŒã€‚

## ä¸»è¦ç‰¹æ€§

### ğŸ¨ ç¾è§‚çš„UIè®¾è®¡
- **ç°ä»£åŒ–ç•Œé¢**ï¼šé‡‡ç”¨æ¸å˜è‰²å½©ã€åœ†è§’è®¾è®¡ã€å¾®å¦™é˜´å½±
- **ç´§å‡‘å¸ƒå±€**ï¼šæœ€å°åŒ–ç©ºç™½åŒºåŸŸï¼Œä¿¡æ¯å¯†åº¦é€‚ä¸­
- **å“åº”å¼è®¾è®¡**ï¼šé€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- **æµç•…åŠ¨ç”»**ï¼šæ‹–æ‹½ã€å±•å¼€ã€æŠ˜å ç­‰æ“ä½œéƒ½æœ‰å¹³æ»‘è¿‡æ¸¡

### ğŸ–±ï¸ æ‹–æ‹½æ’åºåŠŸèƒ½
- **ç›´è§‚æ‹–æ‹½**ï¼šç‚¹å‡»æ‹–æ‹½æ‰‹æŸ„è¿›è¡Œæ’åº
- **è§†è§‰åé¦ˆ**ï¼šæ‹–æ‹½æ—¶çš„é˜´å½±å’Œå€¾æ–œæ•ˆæœ
- **åˆ†å±‚æ’åº**ï¼šçˆ¶åˆ†ç±»å’Œå­åˆ†ç±»å¯ç‹¬ç«‹æ’åº
- **å®æ—¶æ›´æ–°**ï¼šæ‹–æ‹½å®Œæˆåç«‹å³æ›´æ–°æ’åº

### ğŸ’¾ æ™ºèƒ½ä¿å­˜æœºåˆ¶
- **è‡ªåŠ¨ä¿å­˜**ï¼šæ’åºå2ç§’è‡ªåŠ¨ä¿å­˜
- **æ‰‹åŠ¨ä¿å­˜**ï¼šæ”¯æŒå¿«æ·é”®Ctrl+Så’Œä¿å­˜æŒ‰é’®
- **ä¿å­˜çŠ¶æ€**ï¼šå®æ—¶æ˜¾ç¤ºä¿å­˜çŠ¶æ€å’Œç»“æœ
- **é”™è¯¯å¤„ç†**ï¼šç½‘ç»œé”™è¯¯æ—¶çš„é‡è¯•æœºåˆ¶

### ğŸ”„ è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½
- **å…³é—­æ—¶åˆ·æ–°**ï¼šåˆ†ç±»ç®¡ç†å…³é—­åè‡ªåŠ¨åˆ·æ–°ä¸»é¡µé¢
- **å›è°ƒæœºåˆ¶**ï¼šæ”¯æŒè‡ªå®šä¹‰åˆ·æ–°å›è°ƒå‡½æ•°
- **çŠ¶æ€åŒæ­¥**ï¼šç¡®ä¿å‰ç«¯çŠ¶æ€ä¸åç«¯æ•°æ®ä¸€è‡´

### ğŸ” ä¾¿æ·æ“ä½œ
- **æœç´¢è¿‡æ»¤**ï¼šå®æ—¶æœç´¢åˆ†ç±»åç§°
- **æ‰¹é‡æ“ä½œ**ï¼šå±•å¼€/æŠ˜å æ‰€æœ‰åˆ†ç±»
- **å¿«æ·é”®**ï¼šEscå…³é—­ã€Ctrl+Sä¿å­˜
- **é‡ç½®åŠŸèƒ½**ï¼šä¸€é”®é‡ç½®ä¸ºåŸå§‹æ’åº

## æ–‡ä»¶ç»“æ„

```
/workspace/
â”œâ”€â”€ category_management_ui.html      # å®Œæ•´UIæ¼”ç¤ºé¡µé¢
â”œâ”€â”€ category_management.js           # æ ¸å¿ƒJavaScriptç»„ä»¶
â”œâ”€â”€ main_page_integration.html       # ä¸»é¡µé¢é›†æˆç¤ºä¾‹
â””â”€â”€ CATEGORY_MANAGEMENT_UI_GUIDE.md  # ä½¿ç”¨æŒ‡å—ï¼ˆæœ¬æ–‡æ¡£ï¼‰
```

## å¿«é€Ÿå¼€å§‹

### 1. å¼•å…¥ä¾èµ–

```html
<!-- CSSæ ·å¼ï¼ˆå¯ä»¥å•ç‹¬æå–åˆ°CSSæ–‡ä»¶ï¼‰ -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<!-- JavaScriptä¾èµ– -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
<script src="category_management.js"></script>
```

### 2. åŸºç¡€ä½¿ç”¨

```html
<!-- è§¦å‘æŒ‰é’® -->
<button onclick="showCategoryManagement(refreshCallback)">
    <i class="fas fa-layer-group"></i>
    åˆ†ç±»ç®¡ç†
</button>

<script>
// å®šä¹‰åˆ·æ–°å›è°ƒå‡½æ•°
function refreshCallback(hasChanges) {
    if (hasChanges) {
        console.log('åˆ†ç±»å·²æ›´æ–°ï¼Œåˆ·æ–°é¡µé¢æ•°æ®');
        // åœ¨è¿™é‡Œè°ƒç”¨ä½ çš„æ•°æ®åˆ·æ–°é€»è¾‘
        loadScriptsList();
    }
}

// æ˜¾ç¤ºåˆ†ç±»ç®¡ç†ç•Œé¢
function showCategoryManagement(callback) {
    // åˆ›å»ºå¹¶æ˜¾ç¤ºåˆ†ç±»ç®¡ç†ç»„ä»¶
    const categoryManager = new CategoryManagement({
        apiBaseUrl: '/api/v1/scripts',
        autoSaveDelay: 2000,
        onClose: callback
    });
    
    categoryManager.show();
}
</script>
```

### 3. é«˜çº§é…ç½®

```javascript
const categoryManager = new CategoryManagement({
    // APIåŸºç¡€URL
    apiBaseUrl: '/api/v1/scripts',
    
    // è‡ªåŠ¨ä¿å­˜å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
    autoSaveDelay: 2000,
    
    // å…³é—­æ—¶çš„å›è°ƒå‡½æ•°
    onClose: function(hasChanges) {
        if (hasChanges) {
            // æœ‰æ›´æ”¹æ—¶çš„å¤„ç†é€»è¾‘
            refreshScriptsList();
        }
    },
    
    // å¯ä»¥æ·»åŠ æ›´å¤šé…ç½®é€‰é¡¹...
});

// æ˜¾ç¤ºç•Œé¢
categoryManager.show();
```

## APIæ¥å£è¦æ±‚

ç»„ä»¶éœ€è¦åç«¯æä¾›ä»¥ä¸‹APIæ¥å£ï¼š

### 1. è·å–åˆ†ç±»æ ‘
```
GET /api/v1/scripts/categories/tree?include_stats=true
Authorization: Bearer {token}
```

**å“åº”æ ¼å¼ï¼š**
```json
{
    "code": 200,
    "message": "success",
    "data": [
        {
            "id": 34,
            "name": "ç”µç½‘",
            "icon": "fas fa-bolt",
            "sort_order": 1,
            "is_system": false,
            "script_count": 183,
            "children": [
                {
                    "id": 27,
                    "name": "äº§å“å’ŒæœåŠ¡",
                    "sort_order": 1,
                    "script_count": 25
                }
            ]
        }
    ]
}
```

### 2. æ‰¹é‡æ›´æ–°æ’åº
```
POST /api/v1/scripts/categories/batch-sort
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚æ ¼å¼ï¼š**
```json
{
    "categories": [
        {"id": 34, "sort_order": 1},
        {"id": 35, "sort_order": 2},
        {"id": 27, "sort_order": 1}
    ]
}
```

**å“åº”æ ¼å¼ï¼š**
```json
{
    "code": 200,
    "message": "æˆåŠŸæ›´æ–°3ä¸ªåˆ†ç±»çš„æ’åº",
    "data": {
        "updated_count": 3,
        "total_count": 3
    }
}
```

## æ ·å¼å®šåˆ¶

### 1. ä¸»é¢˜è‰²å½©

```css
/* ä¿®æ”¹ä¸»é¢˜è‰² */
:root {
    --primary-color: #667eea;
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
}
```

### 2. é—´è·å’Œå°ºå¯¸

```css
/* è°ƒæ•´é—´è· */
.category-item {
    margin-bottom: 8px; /* å‡å°‘é—´è· */
}

.categories-list {
    padding: 12px 20px; /* è°ƒæ•´å†…è¾¹è· */
}

/* è°ƒæ•´æ¨¡æ€æ¡†å°ºå¯¸ */
.category-management-modal {
    width: 95%;
    max-width: 1000px;
    height: 90vh;
}
```

### 3. å­—ä½“å’Œå›¾æ ‡

```css
/* è‡ªå®šä¹‰å­—ä½“ */
.category-name {
    font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
    font-weight: 500;
}

/* è‡ªå®šä¹‰å›¾æ ‡ */
.category-icon {
    background: linear-gradient(45deg, #ff6b6b, #ee5a24);
}
```

## äº¤äº’ä½“éªŒä¼˜åŒ–

### 1. æ“ä½œä¹ æƒ¯
- **å·¦ä¾§æ‹–æ‹½æ‰‹æŸ„**ï¼šç¬¦åˆç”¨æˆ·ä»å·¦åˆ°å³çš„æ“ä½œä¹ æƒ¯
- **å³ä¾§æ“ä½œæŒ‰é’®**ï¼šç¼–è¾‘ã€åˆ é™¤æŒ‰é’®ä½äºå³ä¾§ï¼Œæ–¹ä¾¿ç‚¹å‡»
- **åŒå‡»ç¼–è¾‘**ï¼šåŒå‡»åˆ†ç±»åç§°å¯å¿«é€Ÿç¼–è¾‘ï¼ˆå¾…å®ç°ï¼‰
- **é”®ç›˜å¯¼èˆª**ï¼šæ”¯æŒTabé”®å¯¼èˆªå’Œå¿«æ·é”®æ“ä½œ

### 2. è§†è§‰åé¦ˆ
- **æ‚¬åœæ•ˆæœ**ï¼šé¼ æ ‡æ‚¬åœæ—¶çš„é¢œè‰²å’Œé˜´å½±å˜åŒ–
- **æ‹–æ‹½åé¦ˆ**ï¼šæ‹–æ‹½æ—¶çš„å€¾æ–œè§’åº¦å’Œé˜´å½±å¢å¼º
- **çŠ¶æ€æŒ‡ç¤º**ï¼šä¿å­˜ã€åŠ è½½ã€é”™è¯¯çŠ¶æ€çš„å›¾æ ‡å’Œé¢œè‰²å˜åŒ–
- **åŠ¨ç”»è¿‡æ¸¡**ï¼šæ‰€æœ‰çŠ¶æ€å˜åŒ–éƒ½æœ‰å¹³æ»‘çš„CSSè¿‡æ¸¡

### 3. æ€§èƒ½ä¼˜åŒ–
- **è™šæ‹Ÿæ»šåŠ¨**ï¼šå¤§é‡åˆ†ç±»æ—¶å¯å¯ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¾…å®ç°ï¼‰
- **é˜²æŠ–å¤„ç†**ï¼šæœç´¢è¾“å…¥å’Œè‡ªåŠ¨ä¿å­˜éƒ½æœ‰é˜²æŠ–å¤„ç†
- **å†…å­˜ç®¡ç†**ï¼šç»„ä»¶é”€æ¯æ—¶æ¸…ç†äº‹ä»¶ç›‘å¬å™¨å’Œå®šæ—¶å™¨

## é›†æˆåˆ°ç°æœ‰é¡¹ç›®

### 1. Vue.jsé›†æˆ

```vue
<template>
  <div>
    <button @click="showCategoryManagement" class="btn btn-primary">
      <i class="fas fa-layer-group"></i>
      åˆ†ç±»ç®¡ç†
    </button>
  </div>
</template>

<script>
import { CategoryManagement } from './category_management.js';

export default {
  data() {
    return {
      categoryManager: null
    };
  },
  methods: {
    showCategoryManagement() {
      if (!this.categoryManager) {
        this.categoryManager = new CategoryManagement({
          apiBaseUrl: this.$api.baseURL + '/scripts',
          onClose: this.onCategoryManagerClose
        });
      }
      this.categoryManager.show();
    },
    
    onCategoryManagerClose(hasChanges) {
      if (hasChanges) {
        // åˆ·æ–°æ•°æ®
        this.$emit('refresh-scripts');
      }
    }
  },
  
  beforeDestroy() {
    if (this.categoryManager) {
      this.categoryManager.destroy();
    }
  }
};
</script>
```

### 2. Reacté›†æˆ

```jsx
import React, { useRef, useEffect } from 'react';
import { CategoryManagement } from './category_management.js';

function CategoryManagerButton({ onRefresh }) {
  const categoryManagerRef = useRef(null);
  
  const showCategoryManagement = () => {
    if (!categoryManagerRef.current) {
      categoryManagerRef.current = new CategoryManagement({
        apiBaseUrl: '/api/v1/scripts',
        onClose: (hasChanges) => {
          if (hasChanges && onRefresh) {
            onRefresh();
          }
        }
      });
    }
    categoryManagerRef.current.show();
  };
  
  useEffect(() => {
    return () => {
      if (categoryManagerRef.current) {
        categoryManagerRef.current.destroy();
      }
    };
  }, []);
  
  return (
    <button onClick={showCategoryManagement} className="btn btn-primary">
      <i className="fas fa-layer-group"></i>
      åˆ†ç±»ç®¡ç†
    </button>
  );
}

export default CategoryManagerButton;
```

### 3. åŸç”ŸJavaScripté›†æˆ

```javascript
// åœ¨ä¸»é¡µé¢ä¸­
class ScriptManager {
  constructor() {
    this.categoryManager = null;
    this.initCategoryManagement();
  }
  
  initCategoryManagement() {
    const openButton = document.getElementById('categoryManagementBtn');
    openButton.addEventListener('click', () => {
      this.showCategoryManagement();
    });
  }
  
  showCategoryManagement() {
    if (!this.categoryManager) {
      this.categoryManager = new CategoryManagement({
        apiBaseUrl: '/api/v1/scripts',
        onClose: (hasChanges) => {
          if (hasChanges) {
            this.refreshScriptsList();
          }
        }
      });
    }
    this.categoryManager.show();
  }
  
  refreshScriptsList() {
    // åˆ·æ–°è¯æœ¯åˆ—è¡¨çš„é€»è¾‘
    console.log('åˆ·æ–°è¯æœ¯åˆ—è¡¨...');
  }
  
  destroy() {
    if (this.categoryManager) {
      this.categoryManager.destroy();
    }
  }
}

// åˆå§‹åŒ–
const scriptManager = new ScriptManager();
```

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•è‡ªå®šä¹‰æ‹–æ‹½æ‰‹æŸ„æ ·å¼ï¼Ÿ
```css
.drag-handle {
    color: #your-color;
    font-size: 18px;
}

.drag-handle:hover {
    color: #your-hover-color;
    background: #your-bg-color;
}
```

### Q2: å¦‚ä½•ç¦ç”¨æŸäº›åˆ†ç±»çš„æ‹–æ‹½ï¼Ÿ
```javascript
// åœ¨CategoryManagementç±»ä¸­ä¿®æ”¹initDragAndDropæ–¹æ³•
initDragAndDrop() {
    const parentContainer = document.getElementById('categoriesList');
    this.parentSortable = Sortable.create(parentContainer, {
        // ...å…¶ä»–é…ç½®
        filter: '.no-drag', // æ·»åŠ è¿‡æ»¤å™¨
        onMove: function(evt) {
            return !evt.related.classList.contains('no-drag');
        }
    });
}
```

### Q3: å¦‚ä½•æ·»åŠ æ›´å¤šæ“ä½œæŒ‰é’®ï¼Ÿ
åœ¨`renderCategoryItem`æ–¹æ³•ä¸­çš„`category-actions`éƒ¨åˆ†æ·»åŠ ï¼š
```html
<button class="action-btn" onclick="customAction(${category.id})" title="è‡ªå®šä¹‰æ“ä½œ">
    <i class="fas fa-custom-icon"></i>
</button>
```

### Q4: å¦‚ä½•å¤„ç†å¤§é‡åˆ†ç±»çš„æ€§èƒ½é—®é¢˜ï¼Ÿ
```javascript
// å¯ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆéœ€è¦é¢å¤–å®ç°ï¼‰
const categoryManager = new CategoryManagement({
    virtualScroll: true,
    itemHeight: 80,
    containerHeight: 400
});
```

## æ€»ç»“

è¿™ä¸ªåˆ†ç±»ç®¡ç†UIç»„ä»¶æä¾›äº†ï¼š

1. âœ… **ç¾è§‚çš„ç°ä»£åŒ–ç•Œé¢**ï¼šæ¸å˜è‰²å½©ã€åœ†è§’è®¾è®¡ã€é€‚å½“é—´è·
2. âœ… **ç›´è§‚çš„æ‹–æ‹½æ’åº**ï¼šå¯è§†åŒ–åé¦ˆã€åˆ†å±‚æ’åºæ”¯æŒ
3. âœ… **æ™ºèƒ½çš„ä¿å­˜æœºåˆ¶**ï¼šè‡ªåŠ¨ä¿å­˜ã€çŠ¶æ€æŒ‡ç¤ºã€é”™è¯¯å¤„ç†
4. âœ… **å®Œå–„çš„åˆ·æ–°æœºåˆ¶**ï¼šå…³é—­åè‡ªåŠ¨åˆ·æ–°ã€å›è°ƒæ”¯æŒ
5. âœ… **ç¬¦åˆæ“ä½œä¹ æƒ¯**ï¼šå¿«æ·é”®ã€æœç´¢ã€æ‰¹é‡æ“ä½œ
6. âœ… **è‰¯å¥½çš„æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ã€é…ç½®çµæ´»ã€æ˜“äºé›†æˆ

é€šè¿‡è¿™ä¸ªç»„ä»¶ï¼Œç”¨æˆ·å¯ä»¥ç›´è§‚åœ°ç®¡ç†åˆ†ç±»æ’åºï¼Œäº«å—æµç•…çš„æ“ä½œä½“éªŒï¼ŒåŒæ—¶ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚